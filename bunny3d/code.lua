-- stanford bunny: https://graphics.stanford.edu/data/3Dscanrep/#bunny
-- simplified here: https://myminifactory.github.io/Fast-Quadric-Mesh-Simplification/
posbox={{-0.09541530162096, 0, -0.06218060106039}, {0.061865199357271, 0.18625000119209, 0.058212801814079}}
--maxabspos=0.18625000119209
maxabspos=1
colors={WHITE=0xfc}
tris={
	WHITE='d3e04bf31a8dddb741631f00dbe44fcd1706e6b440cd1dfaddb741631f00da133d261fabddb741631f00d3e04bf31a8dda133d261fabf94d58ef01baf319586507af00845b4407f5e2ef303a1d00e6b440cd1dfada133d261fabddb741631f00e3ea4d261942e2d555891122e47843d51cb9e3ea4d261942ddb741631f00e6b440cd1dfae47843d51cb9ddb741631f00e5c9220b1b0fe6b440cd1dfae2ef303a1d00e5c9220b1b0fe9dc3abb1d53e6b440cd1dfae47843d51cb9e6b440cd1dfae3ea4d261942e6b440cd1dfaeba445b11d8ee3ea4d261942f319586507affb43588c130700845b4407f5f03d46091e76e3ea4d261942eba445b11d8eec8823f91a52ed282bd119dce5c9220b1b0fed282bd119dce9dc3abb1d53e5c9220b1b0ff03d46091e76eb3c506f15d8e3ea4d261942fb43588c1307f8e9556116adfcce50c91bb0f8e9556116adebef55050f4ff03d46091e76fcce50c91bb0f8e9556116adf03d46091e7600845b4407f5fb43588c1307092058da10b100e6462f1e31fcce50c91bb0fbd845f11ef300845b4407f508ea598a081807ac5896fdd6ede21b1a26d9f7ae20972191ec8823f91a52064631842632fded3174280101372ba5268808ca3b28257508d348461e62fd82404726b8fdfb43f8238b08d348461e6200e6462f1e3100e6462f1e310a5751a2188afcce50c91bb0fd82404726b808d348461e62fdfb43f8238bfd82404726b8eeb33f7922dbf5853b3927be00845b4407f5092058da10b108ea598a0818fded31742801fd82404726b8f5853b3927be064631842632fd82404726b8fded31742801ffdf1e701fd110961f1e1bb60398241224d4ffdf1e701fd10398241224d4f7ae209721910398241224d401372ba52688f9422a57264af7ae209721910398241224d4f9422a57264a01372ba52688fded31742801f9422a57264ad39f55c020c9ca9662552083c9ad58c52529d22c4e9721a2d39f55c020c9d02f51c5252cd80f68041532d395671e1a2ed39f55c020c9d3e04bf31a8dd39f55c020c9d22c4e9721a2d9b260161560d80f68041532d39f55c020c9de7556d31698d9b260161560d39f55c020c9d3e04bf31a8dde7556d31698d39f55c020c9dbe44fcd1706de7556d31698d3e04bf31a8d08d348461e620ccb356b23e910cb3e0520eb10d344291e6008d348461e6210cb3e0520eb0398241224d406463184263201372ba5268808d348461e6208ca3b2825750ccb356b23e9fb43588c1307ebef55050f4ff8e9556116ad06463184263208ca3b282575fd82404726b8e6b440cd1dfaefa342071ed1f03d46091e76f6e06f9af7a6f4347e3df2cbea43795dfd75f6e06f9af7a6e0076c4105e8f0876d84fe480398241224d40e782acd20b90ccb356b23e908d348461e620a5751a2188a00e6462f1e3118222eef1b0f10cb3e0520eb0e782acd20b90398241224d4107d24781d3f0e782acd20b9f5e518262350f7ae20972191ede21b1a26d91bcf3069160718222eef1b0f197823bc172d0646318426320ccb356b23e90b6a352124e110cb3e0520eb1c17417d154014dd435c1c031c063ad7162f1c17417d1540176837ab1c45176837ab1c451c17417d154010cb3e0520eb18222eef1b0f176837ab1c4510cb3e0520eb1c17417d154019074cbe116f14dd435c1c0318222eef1b0f0e782acd20b913a1275e1c7a1c063ad7162f176837ab1c451bcf30691607d39f55c020c9c9ad58c52529d02f51c5252cf6e06f9af7a6ea43795dfd75ea9f776cfd08e2d555891122e165579a0ed7de7556d3169813a1275e1c7a0e782acd20b9107d24781d3f10cb3e0520eb14dd435c1c0310d344291e601bcf306916071f6938710f251c063ad7162f10961f1e1bb6107d24781d3f0398241224d414dd435c1c0319074cbe116f13464e35171a0ccb356b23e908ca3b2825750b6a352124e1e0076c4105e8f6e06f9af7a6ea9f776cfd0814dd435c1c0313464e35171a10d344291e60107d24781d3f10961f1e1bb613a1275e1c7a14d31cb1141b197823bc172d18222eef1b0ff7ae20972191f5e518262350ffdf1e701fd1f6e06f9af7a6fa3372faf181f91f7770f0910646318426320b6a352124e108ca3b28257513464e35171a08d348461e6210d344291e6013464e35171a0a5751a2188a08d348461e62f6e06f9af7a6f91f7770f091f4347e3df2cb13a1275e1c7a10961f1e1bb618222eef1b0f14d31cb1141b18222eef1b0f10961f1e1bb60e782acd20b910cb3e0520eb0ccb356b23e91bcf30691607176837ab1c4518222eef1b0f2545214510da26522b0013c4197823bc172dea9f776cfd08ea43795dfd75e0076c4105e81e4c38bdfde11e4f448f027a203a31e80440f90374d6ee23f6e06f9af7a6ef4c6c6bf87b2a832c15088427242443feba25d232ec09ed1c17417d15401c063ad7162f1f6938710f25dc4c6252ffd0f0876d84fe48de0b6607080b203a31e804401e4f448f027a1e91435d04d01e4c38bdfde11b01432cfa4e1e4f448f027ae0076c4105e8de0b6607080bf0876d84fe48139e2913f1a813194288f24219ed3a87f5601f7b3dfc05bc203a31e804401e91435d04d019ed3a87f5601e4c38bdfde11ad82aa8f8ea114a1c8afac8139e2913f1a81ad82aa8f8ea139e2913f1a819ed3a87f5601ad82aa8f8ea1f6938710f251e9d3fda0dee1c17417d15401b3249ba0cad19074cbe116f1c17417d15402545214510da2a832c15088426522b0013c4203a31e804401f7b3dfc05bc1e9d3fda0dee1ad82aa8f8ea1e4c38bdfde11b1126a2fb1426522b0013c42a832c15088425d232ec09ed1e91435d04d01c17417d15401e9d3fda0dee1f7b3dfc05bc1e91435d04d01e9d3fda0dee203a31e804401e9d3fda0dee1f6938710f251b3249ba0cad1c17417d15401e91435d04d027242443feba2a832c150884288124e408af27242443feba288124e408af2545214510da2545214510da288124e408af2a832c150884e3bb745df71aea43795dfd75f4347e3df2cbdbe44fcd1706ddb741631f00e2d55589112225d232ec09ed197823bc172d24f330a510a125d232ec09ed1bcf30691607197823bc172dd9b260161560dbb562d90f7fda8f68a71253e5c9220b1b0fe2ef303a1d00da133d261fabcd277c56dc71d582720adf43d34c7de0d619fbd845f11ef3f03d46091e76fb4b45082089092058da10b1fb43588c1307fcce50c91bb0d0176b9a0cf0c0cb68240c01cc326b270f1ade0b6607080be0076c4105e8d8116b5606fb1f6938710f251bcf3069160725d232ec09ed0a5751a2188a097b563314fefcce50c91bb0d8116b5606fbdc15686a09dfde0b6607080bebef55050f4feb3c506f15d8f03d46091e76e3d1585dfdb6e165579a0ed7e86c57480a05cbee6a9a0066d58b6b15f7f4cb046b64fa2de3d1585dfdb6e86c57480a05e96056d9025ae3ea4d261942ebef55050f4fe2d555891122e86c57480a05e165579a0ed7e2d555891122cc326b270f1ac0cb68240c01c76e69711573c0d84e500757be6d54d30fe3c1e35e7f0719f319586507afebef55050f4ffb43588c13070646318426320398241224d40ccb356b23e9dde95c9d00f2de0b6607080bdbb562d90f7f159a50e110a913464e35171a19074cbe116f197823bc172d26522b0013c424f330a510a125d232ec09ed203a31e804401f6938710f25d582720adf43d65d7764d544d34c7de0d619e96056d9025aecf65189f7ece3d1585dfdb6f4347e3df2cbf2077ffff2aae3bb745df71a1a7a4b49034019074cbe116f1e4f448f027aebef55050f4fe86c57480a05e2d555891122104354ac11cf13464e35171a159a50e110a91e91435d04d01e4f448f027a1b3249ba0cadd8116b5606fbc76e69711573d80f68041532cd277c56dc71d58b6b15f7f4d6896c7bee071a7a4b49034015b0518c00c319074cbe116fd80f68041532c76e69711573d4d16956175fd0176b9a0cf0c76e69711573d8116b5606fb15b0518c00c3159a50e110a919074cbe116fcd277c56dc71ccea76c6e7b8cd537300f1a5d0176b9a0cf0cbee6a9a0066c0cb68240c01cd537300f1a5cb046b64fa2dd58b6b15f7f4dbb562d90f7fdc15686a09dfda8f68a71253d80f68041532d4d16956175fd395671e1a2ed0176b9a0cf0cc326b270f1ac76e69711573dc15686a09dfd80f68041532da8f68a71253d45b68fcff99d0176b9a0cf0d8116b5606fbdc15686a09dfd8116b5606fbd80f6804153215b0518c00c3104354ac11cf159a50e110a9d9b260161560da8f68a71253d80f68041532104354ac11cf092058da10b113464e35171a13464e35171a092058da10b10a5751a2188adbe44fcd1706e2d555891122de7556d31698dbb562d90f7fd9b260161560de7556d31698d582720adf43cd277c56dc71d6896c7bee0700e6462f1e31fbd845f11ef3fdfb43f8238bdc4c6252ffd0de0b6607080bdde95c9d00f2d4d16956175fca9662552083d395671e1a2e15244fddfcc00b445917034515b0518c00c30b4459170345092058da10b115b0518c00c3092058da10b1104354ac11cf15b0518c00c3e165579a0ed7dbb562d90f7fde7556d31698e3d1585dfdb6dbb562d90f7fe165579a0ed7c76e69711573ca9662552083d4d16956175f092058da10b1097b563314fe0a5751a2188adf9d589aff74dde95c9d00f2e3d1585dfdb61e4f448f027a19074cbe116f1b3249ba0cadcbee6a9a0066d45b68fcff99d58b6b15f7f4dde95c9d00f2dbb562d90f7fe3d1585dfdb6f319586507afe86c57480a05ebef55050f4ffbd845f11ef3fb4b45082089fdfb43f8238bfb4b45082089f03d46091e76fdfb43f8238bc1e35e7f0719c0cb68240c01cbee6a9a0066dbb562d90f7fde0b6607080bdc15686a09dffdfb43f8238beeb33f7922dbfd82404726b8f8067d78eb62f4347e3df2cbf91f7770f091cd537300f1a5d58b6b15f7f4cd277c56dc71e0076c4105e8dd777247fe27d8116b5606fbf03d46091e76eeb33f7922dbfdfb43f8238b07ac5896fdd608ea598a08180b4459170345097b563314fe092058da10b1fcce50c91bb0092058da10b10b445917034508ea598a0818e5c9220b1b0fe06a1ab51f6ae47417ef1ca9f5f62ded2531f9422a57264af5853b3927bef5f62ded2531f5853b3927beef2538192589f9422a57264afded31742801f5853b3927becd97418c1c05d39237ab1e39d3e04bf31a8dea43795dfd75dd777247fe27e0076c4105e8ef2538192589f5853b3927beeeb33f7922dbea8718b00c8ee82317c51876e47417ef1ca9efa342071ed1e6b440cd1dfae9dc3abb1d53da133d261fabd3e04bf31a8dd39237ab1e39e96c1bfc2333e5c9220b1b0fe47417ef1ca9d6b31b4d20c9e06a1ab51f6adf152bb41907d0904af819afcd97418c1c05d3e04bf31a8d26522b0013c425d232ec09ed24f330a510a1eb3c506f15d8ebef55050f4fe3ea4d261942f3902b5e237cf7ae20972191f9422a57264ae5c9220b1b0fe96c1bfc2333ec8823f91a52c1bf55a01fc6c9ad58c52529ca9662552083f5f62ded2531f3902b5e237cf9422a57264acb65508323bed02f51c5252cc9ad58c52529ed282bd119dcf3902b5e237ce9dc3abb1d53f03d46091e76efa342071ed1eeb33f7922dbeeb33f7922dbefa342071ed1e9dc3abb1d53ef7828421cc6ec8823f91a52f3902b5e237cef2538192589eeb33f7922dbe9dc3abb1d53fbd845f11ef3fcce50c91bb0f03d46091e76cd537300f1a5ccea76c6e7b8c9ce6fffecc4ed282bd119dcec8823f91a52ef7828421cc6e9bd701af55be3bb745df71aeca67658f300c61239b91354c83639c31775c53243c11360e96c1bfc2333ede21b1a26d9ec8823f91a52ef7828421cc6f3902b5e237ced282bd119dceba445b11d8ee6b440cd1dfaf03d46091e76e9dc3abb1d53f3902b5e237cef2538192589e5c9220b1b0fdf152bb41907e06a1ab51f6af3902b5e237cf5f62ded2531ef2538192589e3bb745df71ae9bd701af55bef4c6c6bf87bc83639c31775cd97418c1c05c53243c11360ddb420e00b67dd5322b40d67dba32664089ed87e23090400ddb420e00b67dba32664089ecf6739891c8ccd97418c1c05c83639c31775ca9662552083c49562531b3ac1bf55a01fc6cd277c56dc71d0627cd2d81dd0627a9cd804d2136b1bd9e1ce396e2be5a8d0627a9cd804d0627a9cd804ce396e2be5a8cd277c56dc71cc2767f0f340ce396e2be5a8ce396797e370ce396e2be5a8cc2767f0f340cd277c56dc71cc2767f0f340c9ce6fffecc4cd277c56dc71d48c18900e0dd87e23090400d0181ea4034acd97418c1c05d0904af819afcd6f4a2c1caaccea76c6e7b8cd277c56dc71c9ce6fffecc4ef0f2222ed6beaf64187eea5ea4f35c9e96bef0f2222ed6be6803ba2f076eaf64187eea5d0627cd2d81dcd277c56dc71d34c7de0d619ef0f2222ed6be72c31e3f3cde6803ba2f076e72c31e3f3cdef0f2222ed6bebaa231df31de89e2477f8d5ebaa231df31de09d1c23f2a3d0f165ebe717d2136b1bd9e1d582720adf43d87e23090400d48c18900e0dddb420e00b67d48c18900e0ddd5322b40d67ddb420e00b67d11661c6f7cccb046b64fa2dcc2767f0f340cb046b64fa2dc9ce6fffecc4cc2767f0f340c12164b60f73c0cb68240c01c1e35e7f0719c21f5e970ec6c12164b60f73c1e35e7f0719c0275170131cc12164b60f73be6d54d30fe3be6d54d30fe3c12164b60f73c21f5e970ec6be6d54d30fe3c21f5e970ec6c1e35e7f0719c234409a0f33c3513bd40459c61239b91354c61239b91354c53243c11360c234409a0f33d45b68fcff99cbee6a9a0066d0176b9a0cf0c6b633ab043ec52e36900bbec3513bd40459cb9e65a4f9fbcb046b64fa2dd11661c6f7ccc61239b91354c3513bd40459c52e36900bbec8384b3a14efc0275170131cc37549ab0794c12164b60f73c76e69711573c0cb68240c01c234409a0f33c8384b3a14efc37549ab0794c1bf55a01fc6c21a5afd185ac0275170131cc21a5afd185ac12164b60f73c0275170131cc7894c49ff7fcc7040c9f5ffc6303b82fcddbfd153491c8bc1bf55a01fc6c0275170131cc234409a0f33c37549ab0794c3513bd40459cb9e65a4f9fbca926557fcbdcb046b64fa2dc49562531b3ac12164b60f73c1bf55a01fc6d582720adf43d6896c7bee07d0f165ebe717ea43795dfd75e3bb745df71add777247fe27c5524afe036dc7894c49ff7fc6303b82fcddca926557fcbdcbee6a9a0066cb046b64fa2dd0e61952175dd6b31b4d20c9dd5322b40d67c7dc5fc0feebcbee6a9a0066ca926557fcbdc21a5afd185ac1bf55a01fc6c12164b60f73ca2432bcfcbdc3513bd40459c6303b82fcdddc3229fc1440dd5322b40d67df152bb41907d87e23090400da0f2ccff847daca2190fc58ca2432bcfcbdc6b633ab043ec3513bd40459c6303b82fcddc37549ab0794c5524afe036dcfdf2bcfffdfc6b633ab043eca2432bcfcbdc1e35e7f0719c7dc5fc0feebc4115807fe92c3513bd40459c37549ab0794c6303b82fcddc5524afe036dc0d84e500757c7894c49ff7fc1e35e7f0719cbee6a9a0066c7dc5fc0feebd87e23090400d53928160a2bda0f2ccff847c0d84e500757c1e35e7f0719c7894c49ff7fc1e35e7f0719c4115807fe92c7894c49ff7ff8067d78eb62f91f7770f091fa3372faf181f8067d78eb62f2077ffff2aaf4347e3df2cb07ac5896fdd6f94d58ef01ba00845b4407f51a7a4b4903401e4f448f027a1b01432cfa4e1e4c38bdfde1203a31e804401b1126a2fb14d65d7764d544d2136b1bd9e1d34c7de0d619ef4c6c6bf87bf0876d84fe48dc4c6252ffd026403015024a25d232ec09ed27242443febaef4c6c6bf87bf6e06f9af7a6f0876d84fe48c6303b82fcddcc7040c9f5ffcb9d3da6f6b7d39237ab1e39cd97418c1c05cf6739891c8c15244fddfcc013b946a4f4eb0ed650d5f890d87e23090400daca2190fc58d0181ea4034adba32664089edd5322b40d67dc9426610a27d95d618cfe99dde95c9d00f2db925592f9d5ebaa231df31def0f2222ed6be09d1c23f2a308b44e64f3f3fdf74d1ef1b9fca955c7f95af32754d4fbd1f8f5522bf65fecf65189f7ecf94d58ef01ba07ac5896fdd6fca955c7f95a13b946a4f4eb1b01432cfa4e13194288f242dde95c9d00f2df9d589aff74db925592f9d5df9d589aff74e24e5619f9dfdb925592f9d5e7134f97f56ce41a4992f21bdb925592f9d51a7a4b4903401b01432cfa4e15b0518c00c3eca67658f300e3bb745df71af2077ffff2aaf8f5522bf65ff5394c47f256ecf65189f7ece96056d9025ae86c57480a05f32754d4fbd10ed650d5f8900b445917034515244fddfcc013194288f2420c7f458af0bb0827477df1a1f3902b5e237cec8823f91a52f7ae20972191e4d75150f693e7134f97f56cdb925592f9d50b44591703450ed650d5f89007ac5896fdd6e4d75150f693db925592f9d5e24e5619f9dfe96056d9025af32754d4fbd1ecf65189f7ec0ed650d5f89008b44e64f3f307ac5896fdd608b44e64f3f313194288f2420827477df1a115244fddfcc01b01432cfa4e13b946a4f4eb0ed650d5f89013b946a4f4eb13194288f242fca955c7f95af8f5522bf65ff32754d4fbd1f319586507affca955c7f95af32754d4fbd1f76d44bbef0ff7a13ac7e4bef0e43eb7e7720ed650d5f89013194288f24208b44e64f3f31b01432cfa4e19ed3a87f56013194288f24215b0518c00c31b01432cfa4e15244fddfcc026403015024a203a31e8044025d232ec09eddf9d589aff74e3d1585dfdb6e24e5619f9dfe3d1585dfdb6e4d75150f693e24e5619f9df0cdc40faef5307fc3da2eaba029d42f9ec6cecf65189f7eceea148cff03ceaf64187eea5f94d58ef01bafca955c7f95af319586507af27242443feba1b1126a2fb14203a31e8044026403015024a27242443feba203a31e80440e7134f97f56ce3d1585dfdb6ecf65189f7ece7134f97f56ceaf64187eea5e41a4992f21bf5394c47f256eea148cff03cecf65189f7ec029d42f9ec6cf8e44210ea02f76d44bbef0f0003544df87bfca955c7f95a07ac5896fdd608b44e64f3f3fca955c7f95a0003544df87bfdf74d1ef1b9f5394c47f256f8f5522bf65ff76d44bbef0ff8e44210ea02f7a13ac7e4bee7134f97f56cecf65189f7eceaf64187eea5eaf64187eea5f76d44bbef0ff0e43eb7e772fca955c7f95afdf74d1ef1b9f8f5522bf65fe3d1585dfdb6e7134f97f56ce4d75150f693f8e44210ea02029d42f9ec6cf7a13ac7e4be07ac5896fdd608b44e64f3f30003544df87bfdf74d1ef1b9f76d44bbef0ff5394c47f256e86c57480a05f319586507aff32754d4fbd1ea8718b00c8ee47417ef1ca9e45118a307de22142018fdc71b1126a2fb1427242443febacd7b3857f59ec6303b82fcddcb9d3da6f6b7e6803ba2f076e0db40ccf0c2eaf64187eea522142018fdc71a731ea4fbb91b1126a2fb14ca926557fcbdcb9e65a4f9fbd11661c6f7cc1ad82aa8f8ea1b1126a2fb141a731ea4fbb91a731ea4fbb9114a1c8afac81ad82aa8f8eacb046b64fa2dcd537300f1a5c9ce6fffecc4de2b48b5f277d7a54ccef4d1db925592f9d5de2b48b5f277db925592f9d5e41a4992f21bcfbe5e97fa09d11661c6f7ccd95d618cfe99d0627a9cd804d34c7de0d619d2136b1bd9e1dc4c6252ffd0da07694ffe60e3bb745df71aca926557fcbdcfbe5e97fa09c7dc5fc0feebef4c6c6bf87bdc4c6252ffd0e3bb745df71ac49562531b3ac76e69711573c12164b60f73eaf64187eea5eea148cff03cede64493ef98ca2432bcfcbdcd7b3857f59ed9832d77f722029d42f9ec6cfe063879e615f7a13ac7e4be139e2913f1a80d442b47ec51111a32b3ee9b0b8718eff2390d442b47ec51114a1c8afac8e72c31e3f3cdebaa231df31de89e2477f8d5111a32b3ee9b13194288f242139e2913f1a8c6303b82fcddcd7b3857f59eca2432bcfcbd0b8718eff23907692a19ea950d442b47ec51e3bb745df71ada07694ffe60dd777247fe27111a32b3ee9b0d442b47ec510cdc40faef530827477df1a10c7f458af0bb0cdc40faef53139e2913f1a8114a1c8afac80d442b47ec51d11661c6f7ccd45b68fcff99d95d618cfe99ef0f2222ed6bea4f35c9e96bef533689e52f05e14861f1e908b44e64f3f30827477df1a1f6e06f9af7a6f90374d6ee23fa3372faf18108b44e64f3f3051d4cbff274fdf74d1ef1b9f76d44bbef0feaf64187eea5ede64493ef98c7894c49ff7fce195845f9a5cd104ef4fb2807692a19ea9507fc3da2eaba0d442b47ec51051d4cbff27408b44e64f3f305e14861f1e90b8718eff23904df2092ed7107692a19ea95fdf74d1ef1b9051d4cbff27405e14861f1e902903717e84407fc3da2eaba07692a19ea95df492268f9b4da0f2ccff847e89e2477f8d50cdc40faef5305e14861f1e90827477df1a102fe1ba7eebe07692a19ea9504df2092ed71fe063879e61502903717e84407692a19ea95029d42f9ec6c07fc3da2eaba02903717e844dd777247fe27da07694ffe60d45b68fcff99de3b3f29f11fe0db40ccf0c2e6803ba2f07605e14861f1e90cdc40faef53029d42f9ec6cfdf74d1ef1b905e14861f1e9026d4a00f218029d42f9ec6c026d4a00f21805e14861f1e9fe063879e615029d42f9ec6c02903717e844e72c31e3f3cdd9832d77f722e6803ba2f076ce195845f9a5c7dc5fc0feebcfbe5e97fa09cfbe5e97fa09ca926557fcbdd11661c6f7ccf80c2b0fe71dfe063879e61507692a19ea95daca2190fc58da0f2ccff847df492268f9b4daca2190fc58df492268f9b4e0f21ec9f86d02fe1ba7eebef7a51f4beb9b07692a19ea95f7a51f4beb9bf80c2b0fe71d07692a19ea95029d42f9ec6cf76d44bbef0ffdf74d1ef1b9e09d1c23f2a3daca2190fc58e0f21ec9f86df84d1763eeea02fe1ba7eebefe9f167ff0e0f80c2b0fe71dfb7b3849e5d4fe063879e615e772175cea99e09d1c23f2a3ef0f2222ed6bd95d618cfe99da07694ffe60dc4c6252ffd0cd104ef4fb28cc7040c9f5ffc7894c49ff7ff84d1763eeeaf80c1d7aedde02fe1ba7eebeda0f2ccff847d9832d77f722e72c31e3f3cd07fc3da2eaba0cdc40faef530d442b47ec51f80c1d7aeddef7a51f4beb9b02fe1ba7eebece195845f9a5d0c3524df9f3ce124d24f9e1d60a52cff9d3d8235dabfc08db925592f9d5ca2432bcfcbdd9832d77f722cfdf2bcfffdff80c2b0fe71df7a13ac7e4befb7b3849e5d4fe063879e615fb7b3849e5d4f7a13ac7e4be026d4a00f218029d42f9ec6cfdf74d1ef1b9cd104ef4fb28ce195845f9a5ce124d24f9e1d6c43795f1c7de3b3f29f11fe6803ba2f076e0f21ec9f86de89e2477f8d5e09d1c23f2a3d60a52cff9d3ce195845f9a5d8235dabfc08d7a54ccef4d1d60a52cff9d3db925592f9d5ea8718b00c8ee8bb18e10305ee691a58ff92e09d1c23f2a3e017176af2f0dd901700f6ac04df2092ed710b8718eff23902fe1ba7eebece195845f9a5cfbe5e97fa09d8235dabfc08d95d618cfe99d45b68fcff99da07694ffe601b01432cfa4e1e4c38bdfde119ed3a87f560ce361739fd84d0181ea4034adaca2190fc58cc7040c9f5ffcd104ef4fb28ce124d24f9e113194288f242111a32b3ee9b0cdc40faef53f2c22c92e67bf7a13ac7e4bef80c2b0fe71df5394c47f256f76d44bbef0feea148cff03ceba11a24136ee82317c51876ea8718b00c8ef84d1763eeeaf7a51f4beb9bf80c1d7aeddef2c22c92e67bf80c2b0fe71df7a51f4beb9bd34c7de0d619d0627a9cd804d0627cd2d81dc4115807fe92ce195845f9a5c7894c49ff7ff2c22c92e67bef533689e52ff7a13ac7e4becd7b3857f59ecc7040c9f5ffd6c43795f1c7d9204135f10bde2b48b5f277e41a4992f21bd9204135f10bd7a54ccef4d1de2b48b5f277ce195845f9a5c4115807fe92c7dc5fc0feebef84229eecb4f2c22c92e67bf7a51f4beb9bcfdf2bcfffdfd9832d77f722da0f2ccff847e0db40ccf0c2e41a4992f21beaf64187eea5ef4c6c6bf87bf8067d78eb62f90374d6ee23cc2767f0f340ce396797e370d2136b1bd9e1d9204135f10be41a4992f21be0db40ccf0c2ef533689e52ff0e43eb7e772f7a13ac7e4beeca67658f300f8067d78eb62ef4c6c6bf87bf5531886f049e772175cea99f7a51f4beb9bce361739fd84daca2190fc58dd901700f6acce124d24f9e1d9204135f10bd6c43795f1c7d95d618cfe99d8235dabfc08cfbe5e97fa09dd5322b40d67d48c18900e0dd48a17981017d9204135f10bce124d24f9e1d7a54ccef4d10cdc40faef530c7f458af0bb13194288f242e89e2477f8d5da0f2ccff847e72c31e3f3cddaca2190fc58e09d1c23f2a3dd901700f6acd9832d77f722d6c43795f1c7e6803ba2f076cd7b3857f59ed6c43795f1c7d9832d77f722d0e61952175ddd5322b40d67d48a17981017e9bd701af55beca67658f300ef4c6c6bf87bd6c43795f1c7cc7040c9f5ffce124d24f9e1ef533689e52fee253bc8e6fdf0e43eb7e772c53243c11360c8384b3a14efc234409a0f33fa3372faf181f90374d6ee23f8067d78eb62cd7b3857f59ecb9d3da6f6b7cc7040c9f5ffe0f21ec9f86ddf492268f9b4e89e2477f8d5ef0f2222ed6bf2c22c92e67bef84229eecb4d7a54ccef4d1ce195845f9a5d60a52cff9d3ce124d24f9e1d0c3524df9f3d7a54ccef4d1d11661c6f7ccd0f165ebe717d6896c7bee07de3b3f29f11fd9204135f10be0db40ccf0c2f8067d78eb62eca67658f300f2077ffff2aad7a54ccef4d1d0c3524df9f3ce195845f9a5e772175cea99ef0f2222ed6bf7a51f4beb9bef0f2222ed6bef84229eecb4f7a51f4beb9bef0f2222ed6bef533689e52ff2c22c92e67bf0e43eb7e772ee253bc8e6fdeaf64187eea5f5531886f049f7a51f4beb9bf84d1763eeead6c43795f1c7d9204135f10bde3b3f29f11fef533689e52fea4f35c9e96bee253bc8e6fdea4f35c9e96beaf64187eea5ee253bc8e6fdd39237ab1e39cf6739891c8ccf0b313217dc114a1c8afac813b9176b08ef0d671768ff8902fe1ba7eebe058618e6f6f0fe9f167ff0e0de4731901bdee5c9220b1b0fda133d261fab14d31cb1141b18771d5613b6197823bc172dd95d618cfe99dc4c6252ffd0dde95c9d00f2c37549ab0794c0275170131cc0d84e500757d2136b1bd9e1d65d7764d544d582720adf43ca9662552083d39f55c020c9d395671e1a2e22142018fdc727242443feba2545214510dacd6f4a2c1caac9ad58c52529c1bf55a01fc6c0d84e500757c0275170131cbe6d54d30fe3f9c117f31cee05131964181d06a817e91eba14d31cb1141b06a817e91eba0a9d17b9159a0b8718eff23907ad181ef93b02fe1ba7eebec8384b3a14efc41f4cd81dbcc0275170131c2545214510da197823bc172d1c371e331368c5524afe036dc37549ab0794c0d84e500757d39237ab1e39de4731901bdeda133d261fab07c71847073effe917a808520535177702321c371e331368197823bc172d1b6f1c7b11700d671768ff8913b9176b08ef0e5d18a305c5cd6f4a2c1caac41f4cd81dbcc8384b3a14efc0275170131cc41f4cd81dbcbfd153491c8bcd97418c1c05c8384b3a14efc53243c11360c7ad4d4a1fd0c41f4cd81dbccd6f4a2c1caac7ad4d4a1fd0c1bf55a01fc6c41f4cd81dbcc52e36900bbecaac31ae11e4c61239b91354d11661c6f7ccd6896c7bee07d58b6b15f7f4c61239b91354caac31ae11e4c83639c31775f63c1a9d15f5ee961ab9198efdb91a510c6710961f1e1bb606a817e91eba14d31cb1141bd0181ea4034ace361739fd84d48c18900e0dce812b820b34caac31ae11e4c6b633ab043efe9f167ff0e0fccd1ae2f662f59b1745f263cd6f4a2c1caac8384b3a14efcd97418c1c05c1bf55a01fc6c7ad4d4a1fd0cd6f4a2c1caaca9662552083c76e69711573c49562531b3afccd1ae2f662f8d41acaf5c5f59b1745f263cfdf2bcfffdfd22d298e03b8ce812b820b34cd6f4a2c1caacb65508323bec9ad58c52529f8d41acaf5c5ea8718b00c8ef3861a9ef4acccb930b6146ecaac31ae11e4ce812b820b34d11661c6f7ccd58b6b15f7f4d45b68fcff99ccb930b6146ec83639c31775caac31ae11e4cb65508323becd6f4a2c1caad02f51c5252cd22d298e03b8d53928160a2bce812b820b340d671768ff8907c71847073e05351777023206a817e91ebaffdf1e701fd1f5e518262350d0904af819afd22c4e9721a2cd6f4a2c1caad6b31b4d20c9df152bb41907dd5322b40d67ce812b820b34cf0b313217dcccb930b6146eede21b1a26d9e96c1bfc2333e47417ef1ca9c83639c31775cf0b313217dccf6739891c8cf9c117f31ceef5e518262350e82317c51876d8235dabfc08d95d618cfe99db925592f9d5fdb91a510c67ee961ab9198eeba11a24136ed3e04bf31a8dd22c4e9721a2d0904af819afd02f51c5252ccd6f4a2c1caad22c4e9721a2ea8718b00c8eee691a58ff92f3861a9ef4acc6b633ab043ecaac31ae11e4c52e36900bbed0d530b01884cf0b313217dcce812b820b3402fe1ba7eebe07ad181ef93b058618e6f6f0df152bb41907e5c9220b1b0fde4731901bdef59b1745f263f8d41acaf5c5f3861a9ef4ac22142018fdc713b9176b08ef1a731ea4fbb9d53928160a2bd4792a1c0fa3ce812b820b34d4792a1c0fa3d0d530b01884ce812b820b34eea148cff03cf76d44bbef0fede64493ef981b6f1c7b1170197823bc172d17ea1a8410590a9d17b9159a06a817e91eba05131964181d0a9d17b9159a063518bb12b913b9176b08efcf0b313217dcc83639c31775ccb930b6146ed61417270afed48c18900e0dce361739fd84dd777247fe27d45b68fcff99d8116b5606fbd4792a1c0fa3d53928160a2bdba32664089e197823bc172d18771d5613b617ea1a841059d4792a1c0fa3d7f12d1117cfd0d530b01884cfdf2bcfffdfda0f2ccff847d22d298e03b8dc3229fc1440d9ce2d8e18bfdd5322b40d6707ad181ef93b01151af6fc31058618e6f6f00b8718eff23905351777023207ad181ef93b0d671768ff890b8718eff239114a1c8afac814d31cb1141b0a9d17b9159a13b9176b08efdba32664089edc9426610a27d4792a1c0fa3063518bb12b9fd851ad9165afdb91a510c67d61417270afece361739fd84dd901700f6ac01151af6fc3107ad181ef93bfbaf1a6d0817d7f12d1117cfd50d334a1c09d0d530b0188407ad181ef93bffe917a80852fbaf1a6d0817d48c18900e0dd61417270afed48a17981017063518bb12b9fdb91a510c67ffe917a8085213b9176b08ef063518bb12b907c71847073ed50d334a1c09d7f12d1117cfd39237ab1e39dd5322b40d67d7f12d1117cfd4792a1c0fa3f5e518262350e47417ef1ca9e82317c51876e772175cea99e017176af2f0e09d1c23f2a3e772175cea99dd901700f6ace017176af2f0cc2767f0f340d2136b1bd9e1d0f165ebe717d9ce2d8e18bfd7f12d1117cfdd5322b40d67da8e1784128cd48a17981017d61417270afed7f12d1117cfd9ce2d8e18bfd39237ab1e39ffe917a80852fdb91a510c67fbaf1a6d0817da8e1784128cd0e61952175dd48a17981017d87e23090400dba32664089ed53928160a2bd53928160a2bd22d298e03b8da0f2ccff847e16a1705041bd61417270afedd901700f6acbfd153491c8bc41f4cd81dbcc1bf55a01fc6d61417270afee45118a307deda8e1784128cce812b820b34c6b633ab043ecfdf2bcfffdfee961ab9198ee82317c51876eba11a24136ed643186b1f69d6b31b4d20c9d0e61952175de69c1942f6acdd901700f6ace772175cea99df152bb41907d9ce2d8e18bfdc3229fc1440df152bb41907de4731901bded9ce2d8e18bfde4731901bded39237ab1e39d9ce2d8e18bfcc2767f0f340d0f165ebe717d11661c6f7cce69c1942f6ace8bb18e10305dd901700f6ace8bb18e10305e16a1705041bdd901700f6ace16a1705041be45118a307ded61417270afed643186b1f69d0e61952175dda8e1784128c14d31cb1141b13b9176b08ef17ea1a841059d6b31b4d20c9d643186b1f69da8e1784128cdc9426610a27dd5322b40d67d4792a1c0fa301151af6fc31fccd1ae2f662058618e6f6f0e45118a307dedefc17b214e9da8e1784128c06a817e91ebaf5e518262350f9c117f31cee0a9d17b9159a05131964181dfd851ad9165af5531886f049e69c1942f6ace772175cea9913b9176b08ef07c71847073e0e5d18a305c51b6f1c7b117017ea1a8410592545214510dace396e2be5a8d2136b1bd9e1ce396797e370f6251a500aa9ea8718b00c8efbaf1a6d081717ea1a84105918771d5613b614d31cb1141be16a1705041bea8718b00c8ee45118a307de1a731ea4fbb913b9176b08ef114a1c8afac80a9d17b9159afd851ad9165a063518bb12b9fdb91a510c67eba11a24136eea8718b00c8e01151af6fc31f8d41acaf5c5fccd1ae2f66205131964181dee961ab9198ef63c1a9d15f5e8bb18e10305ea8718b00c8ee16a1705041bd39237ab1e39d0d530b01884d50d334a1c092545214510da17ea1a84105913b9176b08eff6251a500aa9fdb91a510c67ea8718b00c8ef84d1763eeeafe9f167ff0e0f59b1745f26310961f1e1bb6ffdf1e701fd106a817e91eba01151af6fc31fbaf1a6d0817f8d41acaf5c50e5d18a305c507c71847073e0d671768ff89dd9b17ef1e98e06a1ab51f6ad6b31b4d20c9da8e1784128cdd9b17ef1e98d6b31b4d20c92545214510da1c371e3313681b6f1c7b117007ad181ef93b053517770232ffe917a80852fd851ad9165a05131964181df63c1a9d15f5ef771a9df415e69c1942f6acf5531886f049ee691a58ff92e8bb18e10305e69c1942f6ac0d671768ff890535177702320b8718eff239d39237ab1e39cf0b313217dcd0d530b01884fe9f167ff0e0058618e6f6f0fccd1ae2f662e47417ef1ca9defc17b214e9e45118a307dee47417ef1ca9da8e1784128cdefc17b214e9e06a1ab51f6add9b17ef1e98da8e1784128c063518bb12b9ffe917a8085207c71847073eede21b1a26d9e47417ef1ca9f5e518262350fbaf1a6d0817fdb91a510c67f6251a500aa9fbaf1a6d0817ea8718b00c8ef8d41acaf5c522142018fdc72545214510da13b9176b08effdb91a510c67fd851ad9165af63c1a9d15f5f84d1763eeeaf59b1745f263f5531886f049f5531886f049f59b1745f263f3861a9ef4acf5531886f049f3861a9ef4acef771a9df415f3861a9ef4acee691a58ff92ef771a9df415ee691a58ff92e69c1942f6acef771a9df415e47417ef1ca9e06a1ab51f6ada8e1784128c',
}
-- sets of: color x1 y1 z1 x2 y2 z2 x3 y3 z3
local drawtris = table()
local drawtriorder = table()
for _,k in ipairs(table.keys(tris)) do
	local s = tris[k]
	assert(#s%36==0)
	local v=table()
	for i=1,#s,4 do
		local x = tonumber(s:sub(i, i+3), 16)
		x = tonumber(ffi.cast('int16_t', x))
		v:insert(x / 32768 * maxabspos)
	end
	assert(#v%9==0)
	for j=1,#v,9 do
		local tri = table()
		drawtris:insert(tri)
		drawtriorder:insert(#drawtris)
		tri:insert(assert(colors[k]))
		for i=0,8 do
			tri:insert(v[j+i])
		end
		-- insert the COM at the end
		tri:insert((tri[2] + tri[5] + tri[8])/3)
		tri:insert((tri[3] + tri[6] + tri[9])/3)
		tri:insert((tri[4] + tri[7] + tri[10])/3)
	end
end

--[[ ortho
local r = maxabspos*1.2
matortho(-r, r, r, -r, -100, 100)
--]]
-- [[ frustum
matfrustum(-.1, .1, .1, -.1, .1, 10)
mattrans(0, -2.5, -1)
--]]

local lmx, lmy = 128, 128

wireframe = false
update=[]do
	cls()
	local changed
	local th = .05
	local mx, my = mouse()
	local dx, dy = mx - lmx, my - lmy
	lmx, lmy = mx, my
	if key'mouse_left' then
		if dx ~= 0 or dy ~= 0 then
			matrot(th*math.sqrt(dx^2+dy^2), -dy, dx, 0)
			changed = true
		end
	end
	if btn'up' then
		matrot(-th, 1, 0, 0)
		changed = true
	elseif btn'down' then
		matrot(th, 1, 0, 0)
		changed = true
	elseif btn'left' then
		matrot(-th, 0, 1, 0)
		changed = true
	elseif btn'right' then
		matrot(th, 0, 1, 0)
		changed = true
	end
	-- TODO instead of sorting tris, use a z-buffer, and use it in the 2nd half of the framebuffer with mode-1 8bpp
	if changed then
		-- FIXME - address ranges are in a state of flux ...
		local matAddr = 0x080a04
		--[[
		local fwdx = ffi.cast('int32_t', peekl(matAddr + 8))
		local fwdy = ffi.cast('int32_t', peekl(matAddr + 8+16))
		local fwdz = ffi.cast('int32_t', peekl(matAddr + 8+32))
		--]]
		-- [[
		local fwdx = ffi.cast('int32_t', peekl(matAddr + 32))
		local fwdy = ffi.cast('int32_t', peekl(matAddr + 36))
		local fwdz = ffi.cast('int32_t', peekl(matAddr + 40))
		--]]
--trace(fwdx, fwdy, fwdz)
		drawtriorder:sort(function(a,b)
			local acx, acy, acz = drawtris[a]:unpack(11)
			local bcx, bcy, bcz = drawtris[b]:unpack(11)
			return acx * fwdx + acy + fwdy + acz * fwdz + .0001 * a
				 > bcx * fwdx + bcy + fwdy + bcz * fwdz + .0001 * b
		end)
	end
	if btnp(4) or btnp(5) or btnp(6) or btnp(7) then
		wireframe = not wireframe
	end
	for _,i in ipairs(drawtriorder) do
		local tri = drawtris[i]
		local c,
			x1,y1,z1,
			x2,y2,z2,
			x3,y3,z3
			= tri:unpack()
		if wireframe then	-- wireframe
			line3d(x1,y1,z1,x2,y2,z2,c)
			line3d(x2,y2,z2,x3,y3,z3,c)
			line3d(x3,y3,z3,x1,y1,z1,c)
		else	-- 2D tris
			tri3d(x1,y1,z1,x2,y2,z2,x3,y3,z3,c)
		end
	end
end
